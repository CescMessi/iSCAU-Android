<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8">

    <!--Import materialize.css-->
    <link type="text/css" rel="stylesheet" href="../public/materialize/css/materialize.css"
          media="screen,projection"/>
    <link rel="stylesheet" type="text/css" href="../public/app-local.css"/>
    <!--Let browser know website is optimized for mobile-->
    <meta name="viewport"
          content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"/>
    <link rel="stylesheet" type="text/css" href="../public/yusi1.0.css"/>
    <script type="text/javascript" src="../public/jquery-2.1.1.min.js"></script>
    <script type="text/javascript" src="../public/func.js"></script>
    <script>
        $(document).ready(function(){
            loadCache();
            load();
        });
        function loadCache(){
						var jsonStr='';
						jsonStr=window.JSAPI.readJsonStringCache('post-'+getQueryString('id'));
 						if(jsonStr!=''){
							var jsonObj=$.parseJSON(jsonStr);
							updatePage(jsonObj);
						}else{
							window.JSAPI.ajaxStart();
						}
        }

        function load(){
           if(!window.JSAPI.isNetworkOk()){
					window.JSAPI.toast('无网络连接');
					window.JSAPI.ajaxFinish();
					loadCache();
					return;
			}

            $.get(
                'http://120.24.164.20/temp-api/activity_post.php',
                {
                    id:getQueryString('id')
                },
                function(data,status){
                    updatePage(data);
                    window.JSAPI.writeJsonStringCacheWithTime('post-'+getQueryString('id'),JSON.stringify(data),5*24*60*60);
					window.JSAPI.ajaxFinish();
				}
            );


        }


//临时
        function updatePage(data){
            if(data.status=='OK'){
                $('#title').html(data.content.title);
                $('#time-publisher').html(data.content['time']+" "+data.content['association']);
                $('#post-content').html(data.content['content']);
            }else{


            }
        }

    </script>
</head>

<body class="page-container">
<div class="page-title">
    <h5 id="title"></h5>
    <span id="time-publisher" style="font-size: 14px;color: gray;"></span>
</div>
<div id="post-content" style="margin-top: 5px;" class="row">

    </div>
    <div class="post-footer">

    </div>

</div>

</body>

</html>